@page "{handler?}/{doctorID?}"

@using MyRazorApp.Pages.Models;

@model SearchModel

<div class="container">

  <main>

    <partial name="_Header" />

    @if (null != Model.Doctors)
    {

      if (0 == Model.Doctors.Count)
      {
        <h2>Search Results</h2>

        <p>No matching doctors found</p>
      }
      else
      {
        <h2>

          @Specialization.GetSpecializationFromSpecCode(Model.Specialization)@("s")
          
          <span> in </span>

          @ClinicLocations.GetReadableLocationFromCityCode(Model.CityCode)

        </h2>

        <div class="table-responsive">

          <table class="table table-striped table-sm">

            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Doctor</th>
                <th scope="col">Name</th>
                <th scope="col">Phone</th>
                <th scope="col">Fees</th>
                <th scope="col">Clinic</th>
                <th scope="col">Consultation</th>
              </tr>
            </thead>
            <tbody>
              @foreach (var doctor in Model.Doctors)
              {
                <tr>
                  <td>
                  </td>
                  <td>
                    <img class="rounded img-fluid d-block m-3"
                         src="@doctor.ProfilePicture"
                         width="60" />
                  </td>
                  <td>
                    @doctor.Name
                    <br />
                    (<small class="text-muted">@doctor.SpecializationNotes</small>)
                  </td>
                  <td>
                    @doctor.Phone

                  </td>
                  <td>
                    Rs. @doctor.Fees
                    <br />
                    (<small class="text-muted">@doctor.FeesNotes</small>)
                  </td>
                  <td>
                    @doctor.ClinicAddress

                  </td>

                  <td>
                    <a asp-page-handler="MakePay" asp-route-doctorID="@doctor.ID" class="mt-3 btn btn-primary">Pay Fees and Consult</a>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      }
    }

    <form method="post">

      <small style="color:red">For this tutorial search Cardiologist, State Arizona, City Douglas. Doctors flemming@gmail.com and gayle@gmail.com have also been added for this search.</small>

      <partial name="_SpecializationCode" for="Specialization" />

      <partial name="_ClinicAreaPIN" for="CityCode" />

      <button type="submit" class="mt-3 btn btn-primary">Search</button>

    </form>

  </main>

  <partial name="_Footer" />

</div>




